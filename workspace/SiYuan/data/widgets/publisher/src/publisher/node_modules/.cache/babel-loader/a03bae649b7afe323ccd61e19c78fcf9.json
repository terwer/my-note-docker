{"ast":null,"code":"var Writable = require('readable-stream/writable');\n\nvar Readable = require('readable-stream/readable');\n\nvar Duplex = require('readable-stream/duplex');\n\nvar DUMMY = new Buffer(0);\n\nvar noop = function () {};\n\nvar toFunction = function (fn) {\n  if (typeof fn === 'function') return fn;\n  return function (cb) {\n    cb(null, fn);\n  };\n};\n\nvar onreadable = function (rs, init) {\n  var reading = false;\n  var destroyed = false;\n\n  rs._read = function () {\n    reading = true;\n  };\n\n  rs.destroy = function () {\n    destroyed = true;\n  };\n\n  init(function (err, source) {\n    if (err) return rs.emit('error', err);\n\n    var fwd = function () {\n      var data;\n\n      while ((data = source.read()) !== null) {\n        reading = false;\n        rs.push(data);\n      }\n    };\n\n    source.on('readable', function () {\n      if (reading) fwd();\n    });\n    source.on('end', function () {\n      fwd();\n      rs.push(null);\n    });\n    source.on('error', function (err) {\n      rs.emit('error', err);\n    });\n    source.on('close', function () {\n      fwd();\n      process.nextTick(function () {\n        rs.emit('close');\n      });\n    });\n\n    rs._read = function () {\n      reading = true;\n      fwd();\n    };\n\n    rs.destroy = function () {\n      if (destroyed) return;\n      destroyed = true;\n      if (source.destroy) source.destroy();\n    };\n\n    if (destroyed) {\n      destroyed = false;\n      rs.destroy();\n      return;\n    }\n\n    if (reading) fwd();\n  });\n  return rs;\n};\n\nvar onwritable = function (ws, init) {\n  var ready = noop;\n  var destroyed = false;\n\n  ws._write = function (data, enc, cb) {\n    ready = cb;\n  };\n\n  ws.destroy = function () {\n    destroyed = true;\n  };\n\n  ws.write(DUMMY);\n  init(function (err, source) {\n    if (err) return ws.emit('error', err);\n    source.on('close', function () {\n      ws.emit('close');\n    });\n    source.on('error', function (err) {\n      ws.emit('error', err);\n    });\n\n    ws._write = function (data, enc, cb) {\n      if (data === DUMMY) return cb();\n      source.write(data, enc, cb);\n    };\n\n    var emit = ws.emit;\n    source.on('finish', function () {\n      emit.call(ws, 'finish');\n    });\n\n    ws.destroy = function () {\n      if (destroyed) return;\n      destroyed = true;\n      if (source.destroy) source.destroy();\n    };\n\n    ws.emit = function (name) {\n      if (name !== 'finish') return emit.apply(ws, arguments);\n      source.end();\n    };\n\n    if (destroyed) {\n      destroyed = false;\n      ws.destroy();\n      return;\n    }\n\n    ready();\n  });\n  return ws;\n};\n\nexports.readable = function (opts, init) {\n  if (arguments.length === 1) return exports.readable(null, opts);\n  if (!opts) opts = {};\n  return onreadable(new Readable(opts), toFunction(init));\n};\n\nexports.writable = function (opts, init) {\n  if (arguments.length === 1) return exports.writable(null, opts);\n  if (!opts) opts = {};\n  return onwritable(new Writable(opts), toFunction(init));\n};\n\nexports.duplex = function (opts, initWritable, initReadable) {\n  if (arguments.length === 2) return exports.duplex(null, opts, initWritable);\n  if (!opts) opts = {};\n  var dupl = new Duplex(opts);\n  onwritable(dupl, toFunction(initWritable));\n  onreadable(dupl, toFunction(initReadable));\n  return dupl;\n};","map":{"version":3,"names":["Writable","require","Readable","Duplex","DUMMY","Buffer","noop","toFunction","fn","cb","onreadable","rs","init","reading","destroyed","_read","destroy","err","source","emit","fwd","data","read","push","on","process","nextTick","onwritable","ws","ready","_write","enc","write","call","name","apply","arguments","end","exports","readable","opts","length","writable","duplex","initWritable","initReadable","dupl"],"sources":["/Users/terwer/Documents/mydocs/my-note-docker/workspace/SiYuan/data/widgets/publisher/src/publisher/node_modules/fwd-stream/index.js"],"sourcesContent":["var Writable = require('readable-stream/writable');\nvar Readable = require('readable-stream/readable');\nvar Duplex = require('readable-stream/duplex');\n\nvar DUMMY = new Buffer(0);\nvar noop = function() {};\n\nvar toFunction = function(fn) {\n\tif (typeof fn === 'function') return fn;\n\treturn function(cb) {\n\t\tcb(null, fn);\n\t};\n};\n\nvar onreadable = function(rs, init) {\n\tvar reading = false;\n\tvar destroyed = false;\n\n\trs._read = function() {\n\t\treading = true;\n\t};\n\n\trs.destroy = function() {\n\t\tdestroyed = true;\n\t};\n\n\tinit(function(err, source) {\n\t\tif (err) return rs.emit('error', err);\n\n\t\tvar fwd = function() {\n\t\t\tvar data;\n\t\t\twhile ((data = source.read()) !== null) {\n\t\t\t\treading = false;\n\t\t\t\trs.push(data);\n\t\t\t}\n\t\t};\n\n\t\tsource.on('readable', function() {\n\t\t\tif (reading) fwd();\n\t\t});\n\n\t\tsource.on('end', function() {\n\t\t\tfwd();\n\t\t\trs.push(null);\n\t\t});\n\n\t\tsource.on('error', function(err) {\n\t\t\trs.emit('error', err);\n\t\t});\n\n\t\tsource.on('close', function() {\n\t\t\tfwd();\n\t\t\tprocess.nextTick(function() {\n\t\t\t\trs.emit('close');\n\t\t\t});\n\t\t});\n\n\t\trs._read = function() {\n\t\t\treading = true;\n\t\t\tfwd();\n\t\t};\n\n\t\trs.destroy = function() {\n\t\t\tif (destroyed) return;\n\t\t\tdestroyed = true;\n\t\t\tif (source.destroy) source.destroy();\n\t\t};\n\n\t\tif (destroyed) {\n\t\t\tdestroyed = false;\n\t\t\trs.destroy();\n\t\t\treturn;\n\t\t}\n\n\t\tif (reading) fwd();\n\t});\n\n\treturn rs;\n};\n\nvar onwritable = function(ws, init) {\n\tvar ready = noop;\n\tvar destroyed = false;\n\n\tws._write = function(data, enc, cb) {\n\t\tready = cb;\n\t};\n\n\tws.destroy = function() {\n\t\tdestroyed = true;\n\t};\n\n\tws.write(DUMMY);\n\n\tinit(function(err, source) {\n\t\tif (err) return ws.emit('error', err);\n\n\t\tsource.on('close', function() {\n\t\t\tws.emit('close');\n\t\t});\n\n\t\tsource.on('error', function(err) {\n\t\t\tws.emit('error', err);\n\t\t});\n\n\t\tws._write = function(data, enc, cb) {\n\t\t\tif (data === DUMMY) return cb();\n\t\t\tsource.write(data, enc, cb);\n\t\t};\n\n\t\tvar emit = ws.emit;\n\n\t\tsource.on('finish', function() {\n\t\t\temit.call(ws, 'finish');\n\t\t});\n\n\t\tws.destroy = function() {\n\t\t\tif (destroyed) return;\n\t\t\tdestroyed = true;\n\t\t\tif (source.destroy) source.destroy();\n\t\t};\n\n\t\tws.emit = function(name) {\n\t\t\tif (name !== 'finish') return emit.apply(ws, arguments);\n\t\t\tsource.end();\n\t\t};\n\n\t\tif (destroyed) {\n\t\t\tdestroyed = false;\n\t\t\tws.destroy();\n\t\t\treturn;\n\t\t}\n\n\t\tready();\n\t});\n\n\treturn ws;\n};\n\nexports.readable = function(opts, init) {\n\tif (arguments.length === 1) return exports.readable(null, opts);\n\tif (!opts) opts = {};\n\treturn onreadable(new Readable(opts), toFunction(init));\n};\n\nexports.writable = function(opts, init) {\n\tif (arguments.length === 1) return exports.writable(null, opts);\n\tif (!opts) opts = {};\n\treturn onwritable(new Writable(opts), toFunction(init));\n};\n\nexports.duplex = function(opts, initWritable, initReadable) {\n\tif (arguments.length === 2) return exports.duplex(null, opts, initWritable);\n\tif (!opts) opts = {};\n\tvar dupl = new Duplex(opts);\n\tonwritable(dupl, toFunction(initWritable));\n\tonreadable(dupl, toFunction(initReadable));\n\treturn dupl;\n};"],"mappings":"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"},"metadata":{},"sourceType":"script"}
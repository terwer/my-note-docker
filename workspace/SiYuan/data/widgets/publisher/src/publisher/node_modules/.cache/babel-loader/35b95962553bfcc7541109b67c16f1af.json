{"ast":null,"code":"import { exportMdContent } from \"@/lib/siYuanApi\";\n\nconst doPublish = (id, type, meta, content) => {\n  console.log(\"doPublish params=>\", {\n    id,\n    type,\n    meta,\n    content\n  }); // const apiParams = getApiParams(type);\n  // console.log(\"doPublish apiParams=>\", {\n  //     \"API_URL\": apiParams.API_URL,\n  //     \"appKey\": apiParams.appKey,\n  //     \"username\": apiParams.username,\n  //     \"apiParams.postidKey\": apiParams.postidKey\n  // });\n  //\n  // // 设置自定义属性\n  // const postidKey = apiParams.postidKey;\n  // const customAttr = {\n  //     \"custom-slug\": \"\",\n  //     \"custom-vuepress-slug\": \"\",\n  //     [postidKey]: \"99999\",\n  // };\n  //\n  // // const wordpressApi = wordpressApiClient(type);\n  // // const result2 = wordpressApi.getPosts(10);\n  // // // @ts-ignore\n  // // result2.then(function (reslove: any, reject: any) {\n  // //     console.log(\"wordpress getPosts=>\", reslove);\n  // // });\n  //\n  // const metaWeblogApi = metaWeblogApiClient(type);\n  // const result = metaWeblogApi.getRecentPosts(10);\n  // result.then(function (posts) {\n  //     console.log(\"metaweblog get recent posts=>\", posts);\n  //     msg.successMsg(window.siyuan.languages.successMsg);\n  // }).catch(function (e) {\n  //     console.error(e);\n  //     msg.alertMsg(window.siyuan.languages.errorMsg);\n  // });\n  //\n  // // fetchPost(\"/api/attr/setBlockAttrs\", {\n  // //     \"id\": id,\n  // //     \"attrs\": customAttr\n  // // }, (response) => {\n  // //     const newmeta = response;\n  // //     console.log(\"doPublish customAttr=>\", customAttr);\n  // //     // console.log(\"doPublish content=>\", content);\n  // // });\n};\n\nexport async function publishMdContent(id, type, meta, callback) {\n  const data = await exportMdContent(id);\n  const content = data.content;\n\n  if (callback) {\n    callback(meta, content);\n  } else {\n    // console.log(\"publishMdContent meta=>\", meta);\n    // console.log(\"publishMdContent md=>\", content);\n    doPublish(id, type, meta, content);\n  }\n}\nexport async function publishHTMLContent(id, type, meta) {\n  await publishMdContent(id, type, meta, function (meta, content) {\n    const html = content; // console.log(\"publishHTMLContent meta=>\", meta);\n    // console.log(\"publishHTMLContent html=>\", html);\n\n    doPublish(id, type, meta, html);\n  });\n}","map":{"version":3,"names":["exportMdContent","doPublish","id","type","meta","content","console","log","publishMdContent","callback","data","publishHTMLContent","html"],"sources":["/Users/terwer/Documents/mydocs/my-note-docker/workspace/SiYuan/data/widgets/publisher/src/publisher/src/lib/publish/publish.js"],"sourcesContent":["import {exportMdContent} from \"@/lib/siYuanApi\";\n\nconst doPublish = (id, type, meta, content) => {\n\n    console.log(\"doPublish params=>\", {id, type, meta, content});\n\n    // const apiParams = getApiParams(type);\n    // console.log(\"doPublish apiParams=>\", {\n    //     \"API_URL\": apiParams.API_URL,\n    //     \"appKey\": apiParams.appKey,\n    //     \"username\": apiParams.username,\n    //     \"apiParams.postidKey\": apiParams.postidKey\n    // });\n    //\n    // // 设置自定义属性\n    // const postidKey = apiParams.postidKey;\n    // const customAttr = {\n    //     \"custom-slug\": \"\",\n    //     \"custom-vuepress-slug\": \"\",\n    //     [postidKey]: \"99999\",\n    // };\n    //\n    // // const wordpressApi = wordpressApiClient(type);\n    // // const result2 = wordpressApi.getPosts(10);\n    // // // @ts-ignore\n    // // result2.then(function (reslove: any, reject: any) {\n    // //     console.log(\"wordpress getPosts=>\", reslove);\n    // // });\n    //\n    // const metaWeblogApi = metaWeblogApiClient(type);\n    // const result = metaWeblogApi.getRecentPosts(10);\n    // result.then(function (posts) {\n    //     console.log(\"metaweblog get recent posts=>\", posts);\n    //     msg.successMsg(window.siyuan.languages.successMsg);\n    // }).catch(function (e) {\n    //     console.error(e);\n    //     msg.alertMsg(window.siyuan.languages.errorMsg);\n    // });\n    //\n    // // fetchPost(\"/api/attr/setBlockAttrs\", {\n    // //     \"id\": id,\n    // //     \"attrs\": customAttr\n    // // }, (response) => {\n    // //     const newmeta = response;\n    // //     console.log(\"doPublish customAttr=>\", customAttr);\n    // //     // console.log(\"doPublish content=>\", content);\n    // // });\n}\n\nexport async function publishMdContent(id, type, meta, callback) {\n    const data = await exportMdContent(id);\n\n    const content = data.content;\n    if (callback) {\n        callback(meta, content);\n    } else {\n        // console.log(\"publishMdContent meta=>\", meta);\n        // console.log(\"publishMdContent md=>\", content);\n        doPublish(id, type, meta, content);\n    }\n}\n\nexport async function publishHTMLContent(id, type, meta) {\n    await publishMdContent(id, type, meta, function (meta, content) {\n        const html = content;\n        // console.log(\"publishHTMLContent meta=>\", meta);\n        // console.log(\"publishHTMLContent html=>\", html);\n        doPublish(id, type, meta, html);\n    });\n}"],"mappings":"AAAA,SAAQA,eAAR,QAA8B,iBAA9B;;AAEA,MAAMC,SAAS,GAAG,CAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAiBC,OAAjB,KAA6B;EAE3CC,OAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkC;IAACL,EAAD;IAAKC,IAAL;IAAWC,IAAX;IAAiBC;EAAjB,CAAlC,EAF2C,CAI3C;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;AACH,CA7CD;;AA+CA,OAAO,eAAeG,gBAAf,CAAgCN,EAAhC,EAAoCC,IAApC,EAA0CC,IAA1C,EAAgDK,QAAhD,EAA0D;EAC7D,MAAMC,IAAI,GAAG,MAAMV,eAAe,CAACE,EAAD,CAAlC;EAEA,MAAMG,OAAO,GAAGK,IAAI,CAACL,OAArB;;EACA,IAAII,QAAJ,EAAc;IACVA,QAAQ,CAACL,IAAD,EAAOC,OAAP,CAAR;EACH,CAFD,MAEO;IACH;IACA;IACAJ,SAAS,CAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAiBC,OAAjB,CAAT;EACH;AACJ;AAED,OAAO,eAAeM,kBAAf,CAAkCT,EAAlC,EAAsCC,IAAtC,EAA4CC,IAA5C,EAAkD;EACrD,MAAMI,gBAAgB,CAACN,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAiB,UAAUA,IAAV,EAAgBC,OAAhB,EAAyB;IAC5D,MAAMO,IAAI,GAAGP,OAAb,CAD4D,CAE5D;IACA;;IACAJ,SAAS,CAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAiBQ,IAAjB,CAAT;EACH,CALqB,CAAtB;AAMH"},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"/*\n * env.js: Simple memory-based store for environment variables\n *\n * (C) 2011, Charlie Robbins and the Contributors.\n *\n */\nvar util = require('util'),\n    common = require('../common'),\n    Memory = require('./memory').Memory; //\n// ### function Env (options)\n// #### @options {Object} Options for this instance.\n// Constructor function for the Env nconf store, a simple abstraction\n// around the Memory store that can read process environment variables.\n//\n\n\nvar Env = exports.Env = function (options) {\n  Memory.call(this, options);\n  options = options || {};\n  this.type = 'env';\n  this.readOnly = true;\n  this.whitelist = options.whitelist || [];\n  this.separator = options.separator || '';\n  this.lowerCase = options.lowerCase || false;\n  this.parseValues = options.parseValues || false;\n  this.transform = options.transform || false;\n\n  if ({}.toString.call(options.match) === '[object RegExp]' && typeof options !== 'string') {\n    this.match = options.match;\n  }\n\n  if (options instanceof Array) {\n    this.whitelist = options;\n  }\n\n  if (typeof options === 'string' || options instanceof RegExp) {\n    this.separator = options;\n  }\n}; // Inherit from the Memory store\n\n\nutil.inherits(Env, Memory); //\n// ### function loadSync ()\n// Loads the data passed in from `process.env` into this instance.\n//\n\nEnv.prototype.loadSync = function () {\n  this.loadEnv();\n  return this.store;\n}; //\n// ### function loadEnv ()\n// Loads the data passed in from `process.env` into this instance.\n//\n\n\nEnv.prototype.loadEnv = function () {\n  var self = this;\n  var env = process.env;\n\n  if (this.lowerCase) {\n    env = {};\n    Object.keys(process.env).forEach(function (key) {\n      env[key.toLowerCase()] = process.env[key];\n    });\n  }\n\n  if (this.transform) {\n    env = common.transform(env, this.transform);\n  }\n\n  this.readOnly = false;\n  Object.keys(env).filter(function (key) {\n    if (self.match && self.whitelist.length) {\n      return key.match(self.match) || self.whitelist.indexOf(key) !== -1;\n    } else if (self.match) {\n      return key.match(self.match);\n    } else {\n      return !self.whitelist.length || self.whitelist.indexOf(key) !== -1;\n    }\n  }).forEach(function (key) {\n    var val = env[key];\n\n    if (self.parseValues) {\n      val = common.parseValues(val);\n    }\n\n    if (self.separator) {\n      self.set(common.key.apply(common, key.split(self.separator)), val);\n    } else {\n      self.set(key, val);\n    }\n  });\n  this.readOnly = true;\n  return this.store;\n};","map":{"version":3,"names":["util","require","common","Memory","Env","exports","options","call","type","readOnly","whitelist","separator","lowerCase","parseValues","transform","toString","match","Array","RegExp","inherits","prototype","loadSync","loadEnv","store","self","env","process","Object","keys","forEach","key","toLowerCase","filter","length","indexOf","val","set","apply","split"],"sources":["/Users/terwer/Documents/mydocs/my-note-docker/workspace/SiYuan/data/widgets/publisher/src/publisher/node_modules/nconf/lib/nconf/stores/env.js"],"sourcesContent":["/*\n * env.js: Simple memory-based store for environment variables\n *\n * (C) 2011, Charlie Robbins and the Contributors.\n *\n */\n\nvar util = require('util'),\n    common = require('../common'),\n    Memory = require('./memory').Memory;\n\n//\n// ### function Env (options)\n// #### @options {Object} Options for this instance.\n// Constructor function for the Env nconf store, a simple abstraction\n// around the Memory store that can read process environment variables.\n//\nvar Env = exports.Env = function (options) {\n  Memory.call(this, options);\n\n  options        = options || {};\n  this.type      = 'env';\n  this.readOnly  = true;\n  this.whitelist = options.whitelist || [];\n  this.separator = options.separator || '';\n  this.lowerCase = options.lowerCase || false;\n  this.parseValues = options.parseValues || false;\n  this.transform = options.transform || false;\n\n  if (({}).toString.call(options.match) === '[object RegExp]'\n      && typeof options !== 'string') {\n    this.match = options.match;\n  }\n\n  if (options instanceof Array) {\n    this.whitelist = options;\n  }\n  if (typeof(options) === 'string' || options instanceof RegExp) {\n    this.separator = options;\n  }\n};\n\n// Inherit from the Memory store\nutil.inherits(Env, Memory);\n\n//\n// ### function loadSync ()\n// Loads the data passed in from `process.env` into this instance.\n//\nEnv.prototype.loadSync = function () {\n  this.loadEnv();\n  return this.store;\n};\n\n//\n// ### function loadEnv ()\n// Loads the data passed in from `process.env` into this instance.\n//\nEnv.prototype.loadEnv = function () {\n  var self = this;\n\n  var env = process.env;\n\n  if (this.lowerCase) {\n    env = {};\n    Object.keys(process.env).forEach(function (key) {\n      env[key.toLowerCase()] = process.env[key];\n    });\n  }\n\n  if (this.transform) {\n    env = common.transform(env, this.transform);\n  }\n\n  this.readOnly = false;\n  Object.keys(env).filter(function (key) {\n    if (self.match && self.whitelist.length) {\n      return key.match(self.match) || self.whitelist.indexOf(key) !== -1\n    }\n    else if (self.match) {\n      return key.match(self.match);\n    }\n    else {\n      return !self.whitelist.length || self.whitelist.indexOf(key) !== -1\n    }\n  }).forEach(function (key) {\n    \n    var val = env[key];\n\n    if (self.parseValues) {\n      val = common.parseValues(val);\n    }\n\n    if (self.separator) {\n      self.set(common.key.apply(common, key.split(self.separator)), val);\n    }\n    else {\n      self.set(key, val);\n    }\n  });\n\n  this.readOnly = true;\n  return this.store;\n};\n\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}
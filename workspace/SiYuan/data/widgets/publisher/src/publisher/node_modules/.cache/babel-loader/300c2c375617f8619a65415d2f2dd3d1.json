{"ast":null,"code":"import { getBlockByID } from './siYuanApi.js';\n/**\n * 获取挂件所在的块ID\n * @returns {Promise<string>}\n */\n\nexport async function getWidgetId() {\n  const self = window.frameElement.parentElement.parentElement;\n  return self.getAttribute('data-node-id');\n}\n/**\n * 发送请求获取当前文档\n * @returns {Promise<*>}\n */\n\nexport async function getPage(widgetId) {\n  return await getBlockByID(widgetId);\n}\n/**\n * 获取文档ID\n * @returns {Promise<*|string>}\n */\n// eslint-disable-next-line no-unused-vars\n// async function getPageId(widgetId) {\n//     // eslint-disable-next-line no-undef\n//     const page = await getPage(widgetId)\n//     if (!page) {\n//         alert(\"未获取到文档信息，请等待几秒再试。。。\");\n//     }\n//     return page.root_id || \"\";\n// }\n\n/**\n * 获取文档中的所有块\n * @returns {Promise<*|null>}\n */\n// eslint-disable-next-line no-unused-vars\n// async function getInfoBlocks(widgetId) {\n//     // eslint-disable-next-line no-undef\n//     let page_id = await getPageId(widgetId);\n//\n//     const sql_sentence = \"select * from blocks where type = 'p' and (root_id = \" + \"'\" + page_id + \"'\" + \" or path like '%\" + page_id + \"%')\";\n//     //console.log(sql_sentence);\n//     //console.log(res);\n//     return await sql(sql_sentence);\n// }\n\n/**\n * 获取文档中的所有信息\n * @returns {Promise<string>}\n */\n// eslint-disable-next-line no-unused-vars\n// async function getPageContent(widgetId) {\n//     // 获取当前块信息和文字\n//     // eslint-disable-next-line no-undef\n//     const res = await getInfoBlocks(widgetId)\n//     const resLength = res.length;\n//     let all_character = '';\n//     for (let i = 0; i < resLength; i++) {\n//         if (res[i].content) {\n//             all_character += res[i].content + '\\n';\n//         }\n//     }\n//     return all_character;\n// }","map":{"version":3,"names":["getBlockByID","getWidgetId","self","window","frameElement","parentElement","getAttribute","getPage","widgetId"],"sources":["/Users/terwer/Documents/mydocs/my-note-docker/workspace/SiYuan/data/widgets/publisher/src/publisher/src/lib/siyuanUtil.js"],"sourcesContent":["import {getBlockByID} from './siYuanApi.js';\n\n/**\n * 获取挂件所在的块ID\n * @returns {Promise<string>}\n */\nexport async function getWidgetId() {\n    const self = window.frameElement.parentElement.parentElement;\n    return self.getAttribute('data-node-id');\n}\n\n/**\n * 发送请求获取当前文档\n * @returns {Promise<*>}\n */\nexport async function getPage(widgetId) {\n    return await getBlockByID(widgetId);\n}\n\n/**\n * 获取文档ID\n * @returns {Promise<*|string>}\n */\n// eslint-disable-next-line no-unused-vars\n// async function getPageId(widgetId) {\n//     // eslint-disable-next-line no-undef\n//     const page = await getPage(widgetId)\n//     if (!page) {\n//         alert(\"未获取到文档信息，请等待几秒再试。。。\");\n//     }\n//     return page.root_id || \"\";\n// }\n\n/**\n * 获取文档中的所有块\n * @returns {Promise<*|null>}\n */\n// eslint-disable-next-line no-unused-vars\n// async function getInfoBlocks(widgetId) {\n//     // eslint-disable-next-line no-undef\n//     let page_id = await getPageId(widgetId);\n//\n//     const sql_sentence = \"select * from blocks where type = 'p' and (root_id = \" + \"'\" + page_id + \"'\" + \" or path like '%\" + page_id + \"%')\";\n//     //console.log(sql_sentence);\n//     //console.log(res);\n//     return await sql(sql_sentence);\n// }\n\n/**\n * 获取文档中的所有信息\n * @returns {Promise<string>}\n */\n// eslint-disable-next-line no-unused-vars\n// async function getPageContent(widgetId) {\n//     // 获取当前块信息和文字\n//     // eslint-disable-next-line no-undef\n//     const res = await getInfoBlocks(widgetId)\n//     const resLength = res.length;\n//     let all_character = '';\n//     for (let i = 0; i < resLength; i++) {\n//         if (res[i].content) {\n//             all_character += res[i].content + '\\n';\n//         }\n//     }\n//     return all_character;\n// }"],"mappings":"AAAA,SAAQA,YAAR,QAA2B,gBAA3B;AAEA;AACA;AACA;AACA;;AACA,OAAO,eAAeC,WAAf,GAA6B;EAChC,MAAMC,IAAI,GAAGC,MAAM,CAACC,YAAP,CAAoBC,aAApB,CAAkCA,aAA/C;EACA,OAAOH,IAAI,CAACI,YAAL,CAAkB,cAAlB,CAAP;AACH;AAED;AACA;AACA;AACA;;AACA,OAAO,eAAeC,OAAf,CAAuBC,QAAvB,EAAiC;EACpC,OAAO,MAAMR,YAAY,CAACQ,QAAD,CAAzB;AACH;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"},"metadata":{},"sourceType":"module"}
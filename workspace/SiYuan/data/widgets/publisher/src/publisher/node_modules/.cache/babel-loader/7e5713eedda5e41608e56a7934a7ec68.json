{"ast":null,"code":"const nconf = require('nconf');\n\nconst path = require('path');\n\nconst resolve = dir => path.join(__dirname, dir);\n\nexport function getConf(key) {\n  const confPath = resolve(\"./data/conf.json\");\n  nconf.file({\n    file: confPath\n  });\n  return nconf.get(key);\n}\nexport async function setConf(key, value) {\n  const confPath = resolve(\"./data/conf.json\");\n  nconf.file({\n    file: confPath\n  });\n  return new Promise((resolve, reject) => {\n    nconf.set(key, value);\n    nconf.save(confPath, function (err, data) {\n      if (err) {\n        reject(err);\n      }\n\n      if (data) {\n        console.log(\"setConf结果=>\", JSON.parse(data.toString()));\n        resolve(data);\n      }\n    });\n  });\n} // export async function setConfList(confList) {\n//     if (!confList || confList.length === 0) {\n//         console.error(\"conf cannot be empty\")\n//         return\n//     }\n//\n//     const confPath = resolve(\"./data/conf.json\")\n//     nconf.file({file: confPath});\n//\n//     return new Promise((resolve, reject) => {\n//         for (let i = 0; i < confList.length; i++) {\n//             const conf = confList[i];\n//             nconf.set(conf.key, conf.value)\n//         }\n//\n//         nconf.save(confPath, function (err, data) {\n//             if (err) {\n//                 reject(err)\n//             }\n//\n//             if (data) {\n//                 console.log(\"setConf结果=>\", JSON.parse(data.toString()))\n//                 resolve(data)\n//             }\n//         })\n//     })\n// }","map":{"version":3,"names":["nconf","require","path","resolve","dir","join","__dirname","getConf","key","confPath","file","get","setConf","value","Promise","reject","set","save","err","data","console","log","JSON","parse","toString"],"sources":["/Users/terwer/Documents/mydocs/my-note-docker/workspace/SiYuan/data/widgets/publisher/src/publisher/src/lib/config.js"],"sourcesContent":["const nconf = require('nconf');\nconst path = require('path')\nconst resolve = (dir) => path.join(__dirname, dir)\n\nexport function getConf(key) {\n    const confPath = resolve(\"./data/conf.json\")\n    nconf.file({file: confPath});\n\n    return nconf.get(key)\n}\n\nexport async function setConf(key, value) {\n    const confPath = resolve(\"./data/conf.json\")\n    nconf.file({file: confPath});\n\n    return new Promise((resolve, reject) => {\n        nconf.set(key, value)\n        nconf.save(confPath, function (err, data) {\n            if (err) {\n                reject(err)\n            }\n\n            if (data) {\n                console.log(\"setConf结果=>\", JSON.parse(data.toString()))\n                resolve(data)\n            }\n        })\n    })\n}\n\n// export async function setConfList(confList) {\n//     if (!confList || confList.length === 0) {\n//         console.error(\"conf cannot be empty\")\n//         return\n//     }\n//\n//     const confPath = resolve(\"./data/conf.json\")\n//     nconf.file({file: confPath});\n//\n//     return new Promise((resolve, reject) => {\n//         for (let i = 0; i < confList.length; i++) {\n//             const conf = confList[i];\n//             nconf.set(conf.key, conf.value)\n//         }\n//\n//         nconf.save(confPath, function (err, data) {\n//             if (err) {\n//                 reject(err)\n//             }\n//\n//             if (data) {\n//                 console.log(\"setConf结果=>\", JSON.parse(data.toString()))\n//                 resolve(data)\n//             }\n//         })\n//     })\n// }"],"mappings":"AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAC,MAAD,CAApB;;AACA,MAAME,OAAO,GAAIC,GAAD,IAASF,IAAI,CAACG,IAAL,CAAUC,SAAV,EAAqBF,GAArB,CAAzB;;AAEA,OAAO,SAASG,OAAT,CAAiBC,GAAjB,EAAsB;EACzB,MAAMC,QAAQ,GAAGN,OAAO,CAAC,kBAAD,CAAxB;EACAH,KAAK,CAACU,IAAN,CAAW;IAACA,IAAI,EAAED;EAAP,CAAX;EAEA,OAAOT,KAAK,CAACW,GAAN,CAAUH,GAAV,CAAP;AACH;AAED,OAAO,eAAeI,OAAf,CAAuBJ,GAAvB,EAA4BK,KAA5B,EAAmC;EACtC,MAAMJ,QAAQ,GAAGN,OAAO,CAAC,kBAAD,CAAxB;EACAH,KAAK,CAACU,IAAN,CAAW;IAACA,IAAI,EAAED;EAAP,CAAX;EAEA,OAAO,IAAIK,OAAJ,CAAY,CAACX,OAAD,EAAUY,MAAV,KAAqB;IACpCf,KAAK,CAACgB,GAAN,CAAUR,GAAV,EAAeK,KAAf;IACAb,KAAK,CAACiB,IAAN,CAAWR,QAAX,EAAqB,UAAUS,GAAV,EAAeC,IAAf,EAAqB;MACtC,IAAID,GAAJ,EAAS;QACLH,MAAM,CAACG,GAAD,CAAN;MACH;;MAED,IAAIC,IAAJ,EAAU;QACNC,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BC,IAAI,CAACC,KAAL,CAAWJ,IAAI,CAACK,QAAL,EAAX,CAA3B;QACArB,OAAO,CAACgB,IAAD,CAAP;MACH;IACJ,CATD;EAUH,CAZM,CAAP;AAaH,C,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"},"metadata":{},"sourceType":"module"}